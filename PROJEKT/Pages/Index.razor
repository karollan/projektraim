@page "/"
@inject HttpClient Http
@using Shared.Models
@using ViewModels
@using FormModels 
@inject IJSRuntime js


<div @ref="container">
    <div class="container mt-5">
        <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-8">

                    <h1 id="survey">Ocena wiedzy studentów ETI na temat szczepionek</h1>
                    <div class="all-steps" id="all-steps"> <span class="step"><i class="fa fa-user"></i></span> <span class="step"><i class="fa fa-map-marker"></i></span> <span class="step"><i class="fa fa-shopping-bag"></i></span> <span class="step"><i class="fa fa-car"></i></span> <span class="step"><i class="fa fa-spotify"></i></span> <span class="step"><i class="fa fa-mobile-phone"></i></span> </div>
                    <div class="tab">
                        <EditForm Model="@rUser" OnValidSubmit="@next">

                            <DataAnnotationsValidator />
                            <Microsoft.AspNetCore.Components.Forms.ValidationSummary />
                            <h3>Pytania o historię szczepień:</h3>

                            <h6>Wiek:</h6>
                            <MatRadioGroup @bind-Value="@rUser.Age" TValue="string">
                                <MatRadioButton Class="etap1" Value="@("<18")" TValue="string" Label="Mniej niż 18"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("18-26")" TValue="string" Label="18-26"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("27-35")" TValue="string" Label="27-35"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("36-65")" TValue="string" Label="36-65"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@(">65")" TValue="string" Label="Więcej niż 65"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>Płeć:</h6>
                            <MatRadioGroup @bind-Value="@rUser.Gender" TValue="string">
                                <MatRadioButton Class="etap1" Value="@("M")" TValue="string" Label="Mężczyzna"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("K")" TValue="string" Label="Kobieta"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("I")" TValue="string" Label="Nie chcę odpowiadać na to pytanie"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>Wykształcenie:</h6>
                            <MatRadioGroup @bind-Value="@rUser.Education" TValue="string">
                                <MatRadioButton Class="etap1" Value="@("podstawowe")" TValue="string" Label="Podstawowe"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("zasadnicze")" TValue="string" Label="Zasadnicze zawodowe"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("srednie")" TValue="string" Label="Średnie"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("wyzsze")" TValue="string" Label="Wyższe"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>Czy jesteś studentem?</h6>
                            <MatRadioGroup @bind-Value="@rUser.Student_eti" TValue="string">
                                <MatRadioButton Class="etap1" Value="@("NS")" TValue="string" Label="Nie studiuję"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("SETI")" TValue="string" Label="Jestem studentem ETI na PG"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("SPG")" TValue="string" Label="Jestem studentem innego wydziału PG"></MatRadioButton>
                                <MatRadioButton Class="etap1" Value="@("SNPG")" TValue="string" Label="Jestem studentem innej uczelni"></MatRadioButton>
                            </MatRadioGroup>
                            <button type="submit">Dalej</button>
                        </EditForm>
                    </div>

                
                    <div class="tab">
                        <EditForm Model="@history" OnValidSubmit="@next">

                            <DataAnnotationsValidator />
                            <Microsoft.AspNetCore.Components.Forms.ValidationSummary />
                            <h3>Pytania o historię szczepień:</h3>

                            <h6>Czy szczepiłeś/aś się na ospę wietrzną?</h6>
                            <MatRadioGroup @bind-Value="@history.Chickenpox" TValue="string">
                                <MatRadioButton Value="@("tak")" TValue="string" Style="float:left; margin-right: 5px" Label="Tak"></MatRadioButton>
                                <MatRadioButton Value="@("nie")" TValue="string" Style="float:left; margin-right: 5px" Label="Nie"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>Czy kiedykolwiek szczepiłeś/aś się na grypę?</h6>
                            <MatRadioGroup @bind-Value="@history.Flu" TValue="string">
                                <MatRadioButton Value="@("tak")" TValue="string" Style="float:left; margin-right: 5px" Label="Tak"></MatRadioButton>
                                <MatRadioButton Value="@("nie")" TValue="string" Style="float:left; margin-right: 5px" Label="Nie"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>Czy szczepiłeś/aś się przeciw HPV?</h6>
                            <MatRadioGroup @bind-Value="@history.HPV" TValue="string">
                                <MatRadioButton Value="@("tak")" TValue="string" Style="float:left; margin-right: 5px" Label="Tak"></MatRadioButton>
                                <MatRadioButton Value="@("nie")" TValue="string" Style="float:left; margin-right: 5px" Label="Nie"></MatRadioButton>
                            </MatRadioGroup>
                            <button type="submit">Dalej</button>
                        </EditForm>
                    </div>



                    <div class="tab">
                        <EditForm Model="@opinion" OnValidSubmit="@next">

                            <DataAnnotationsValidator />
                            <Microsoft.AspNetCore.Components.Forms.ValidationSummary />

                            <h3>Pytania o opinię:</h3>

                            <h6>
                                Jaki jest twój stosunek do szczepień obowiązkowych (odra, świnka, różyczka…)?
                                Oceń w skali od 1 (bardzo pozytywny) do 5 (bardzo negatywny)
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.CompulsoryVaccination" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Bardzo pozytywny"></MatRadioButton>
                                <MatRadioButton Value="@("A")" TValue="string" Label="Pozytywny"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="Nie wiem / Obojętny"></MatRadioButton>
                                <MatRadioButton Value="@("D")" TValue="string" Label="Negatywny"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Bardzo negatywny"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>
                                Jaki jest twój stosunek do szczepień nieobowiązkowych (grypa, ospa, ...)?
                                Oceń w skali od 1 (bardzo negatywny) do 5 (bardzo pozytywny)
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.OptionalVaccination" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Bardzo pozytywny"></MatRadioButton>
                                <MatRadioButton Value="@("A")" TValue="string" Label="Pozytywny"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="Nie wiem / Obojętny"></MatRadioButton>
                                <MatRadioButton Value="@("D")" TValue="string" Label="Negatywny"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Bardzo negatywny"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>
                                Czy planujesz zaszczepić się na COVID-19?
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.CovidVaccination" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Tak / Już się zaszczepiłem/am"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Nie"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="NIe jestem pewny/a"></MatRadioButton>
                            </MatRadioGroup>


                            <h6>
                                Czy martwisz się o bezpieczeństwo i skuteczność szczepionki COVID-19?
                                Oceń w skali od 1 (zdecydowanie się zgadzam) do 5 (zdecydowanie się nie zgadzam)
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.CovidVacSafety" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Zdecydowanie się zgadzam"></MatRadioButton>
                                <MatRadioButton Value="@("A")" TValue="string" Label="Zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="Nie wiem / Obojętny"></MatRadioButton>
                                <MatRadioButton Value="@("D")" TValue="string" Label="Nie zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Zdecydowanie się nie zgadzam"></MatRadioButton>
                            </MatRadioGroup>

                            <h6>
                                Lepiej jest uzyskać odporność poprzez zachorowanie niż szczepienie.
                                Odpowiedź w skali  od 1 (zdecydowanie się zgadzam) do 5 (zdecydowanie się nie zgadzam)
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.DiseaseOrVaccine" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Zdecydowanie się zgadzam"></MatRadioButton>
                                <MatRadioButton Value="@("A")" TValue="string" Label="Zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="Nie wiem / Obojętny"></MatRadioButton>
                                <MatRadioButton Value="@("D")" TValue="string" Label="Nie zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Zdecydowanie się nie zgadzam"></MatRadioButton>
                            </MatRadioGroup>


                            <h6>
                                Ufam informacjom, które otrzymuję na temat szczepionek.
                                Odpowiedź w skali  od 1 (zdecydowanie się zgadzam) do 5 (zdecydowanie się nie zgadzam)
                            </h6>
                            <MatRadioGroup @bind-Value="@opinion.InformationTrust" TValue="string">
                                <MatRadioButton Value="@("SA")" TValue="string" Label="Zdecydowanie się zgadzam"></MatRadioButton>
                                <MatRadioButton Value="@("A")" TValue="string" Label="Zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("NS")" TValue="string" Label="Nie wiem / Obojętny"></MatRadioButton>
                                <MatRadioButton Value="@("D")" TValue="string" Label="Nie zgadzam się"></MatRadioButton>
                                <MatRadioButton Value="@("SD")" TValue="string" Label="Zdecydowanie się nie zgadzam"></MatRadioButton>
                            </MatRadioGroup>
                            <button type="submit">Dalej</button>
                        </EditForm>
                    </div>

                    <div class="tab">
                        <EditForm Model="@knowledge" OnValidSubmit="@HandleValidSubmit">

                            <DataAnnotationsValidator />
                            <Microsoft.AspNetCore.Components.Forms.ValidationSummary />

                            <h6>
                                Kto lub co jest Twoim głównym źródłem wiedzy o szczepieniach ochronnych?
                            </h6>

                            <MatRadioGroup @bind-Value="@knowledge.Source" TValue="string">
                                <MatRadioButton Value="@("telewizja")" TValue="string" Label="Telewizja"></MatRadioButton>
                                <MatRadioButton Value="@("internet")" TValue="string" Label="Internet"></MatRadioButton>
                                <MatRadioButton Value="@("szkoła")" TValue="string" Label="Szkoła"></MatRadioButton>
                                <MatRadioButton Value="@("ksiazki")" TValue="string" Label="Książki"></MatRadioButton>
                                <MatRadioButton Value="@("gazety")" TValue="string" Label="Gazety"></MatRadioButton>
                                <MatRadioButton Value="@("zaszczepieni")" TValue="string" Label="Osoby zaszczepione"></MatRadioButton>
                                <MatRadioButton Value="@("rodzina")" TValue="string" Label="Rodzina i znajomi"></MatRadioButton>
                                <MatRadioButton Value="@("lekarze")" TValue="string" Label="Lekarze i pielęgniarki"></MatRadioButton>
                                <MatRadioButton Value="@("brak")" TValue="string" Label="Nie szukam informacji o szczepieniach"></MatRadioButton>
                            </MatRadioGroup>
                            <button type="submit">Dalej</button>
                        </EditForm>
                    </div>

                    <div class="tab">
                        <h2>Test wiedzy:</h2>





                        <h6>
                            1. Kto lub co jest Twoim głównym źródłem wiedzy o szczepieniach ochronnych?
                        </h6>
                    </div>

                    <div style="overflow:auto;" id="nextprevious">
                        <div style="float:right;"> <button type="button" id="prevBtn" @onclick="@prev"><i class="fa fa-angle-double-left"></i></button> <button type="button" id="nextBtn" @onclick="@next"><i class="fa fa-angle-double-right"></i></button> </div>
                    </div>





                @*
                    /////////////////////////////////////////

                *@


                    <div class="progress">
                        <div class="progress-bar progress-bar-striped" role="progressbar"
                             style="width: @wizard.Progress" aria-valuenow=@wizard.Progress
                             aria-valuemin="0" aria-valuemax="100"></div>
                    </div>


                    <div>

                        <div>
                            <p>
                                <label>
                                    Czym różnią się szczepienia obowiązkowe od zalecanych?
                                </label>
                                <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                    <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia obowiązkowe obejmują kwalifikację do szczepienia, natomiast zalecanych to nie dotyczy.</MatRadioButton>
                                    <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia obowiązkowe są ważne, a zalecane mniej ważne.</MatRadioButton>
                                    <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Szczepienia obowiązkowe są bezpłatne</MatRadioButton>
                                    <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia obowiązkowe dotyczą dzieci, a zalecane – dorosłych</MatRadioButton>
                                </MatRadioGroup>
                            </p>
                        </div>

                        <p>
                            <label>
                                Do szczepień obowiązkowych należą:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia niemowląt przeciw meningokokom grupy B i rotawirusom.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Szczepienia dzieci przeciw odrze, śwince i różyczce.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia przypominające dorosłych przeciw błonicy, tężcowi i krztuścowi.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia przeciw wirusowemu zapaleniu wątroby typu B dzieci, młodzieży i dorosłych.</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Szczepienia poekspozycyjne są to szczepienia wykonywane po narażeniu na czynnik zakaźny,
                                (np. po bezpośrednim kontakcie z osobą, która zaraża).
                                Do obowiązkowych szczepień poekspozycyjnych należą:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tylko szczepienia przeciw tężcowi i wściekliźnie.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Szczepienia przeciw odrze i ospie wietrznej.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Szczepienia przeciw błonicy, tężcowi i wściekliźnie.</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tylko szczepienia przeciw wściekliźnie.</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Pierwsza opracowana szczepionka była przeciwko ospie prawdziwej:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Prawda</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Fałsz</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Chorobą, która została całkowicie wyeliminowana z powierzchni ziemi dzięki szczepieniom jest:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">dur brzuszny</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int"> ospa prawdziwa</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">poliomyelitis</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">dżuma</MatRadioButton>
                            </MatRadioGroup>>
                        </p>

                        <p>
                            <label>
                                Które z poniższych NIE jest chorobą, której można zapobiec dzięki szczepieniu?
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Rak szyjki macicy</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Odra</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Paraliż dziecięcy</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Astma</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Krztusiec powrócił, ponieważ:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Oryginalna szczepionka nie była skuteczna</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Niewystarczająca liczba rodziców szczepiła swoje dzieci (ruchy antyszczepionkowców)</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Nowy szczep wirusa przybył do Stanów Zjednoczonych z zagranicy w latach siedemdziesiątych XX wieku</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Oryginalna szczepionka została celowo osłabiona</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Która pandemia wybuchła w 1918 roku?  
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Grypa hiszpanka</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Ebola</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Dżuma</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Świńska grypa</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Inna nazwa wirusa grypy A/H1N1, który przerodził się w pandemię to:
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Ptasia grypa</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Świńska grypa</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Grypa hiszpanka</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Wirus HIV</MatRadioButton>
                            </MatRadioGroup>>
                        </p>

                        <p>
                            <label>
                                Czy wirus dżumy zaliczany jest do broni biologicznej?
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Tak</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Nie</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Dorośli potrzebują dawki przypominającej przeciwko tężcowi i błonicy co 10 lat.
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Prawda</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Fałsz</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Czy wszystkie 3 dostępne szczepionki na koronawirusa (Pfizer/Moderna/AstraZeneca) to szczepionki mRNA?  
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tak</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Nie</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Czy przyjęcie szczepionki na COVID-19 może wywołać zakażenie koronawirusem?
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tak</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Nie</MatRadioButton>
                            </MatRadioGroup>>
                        </p>

                        <p>
                            <label>
                                Czy szczepionka wykorzystująca mRNA może wpłynąć na materiał genetyczny człowieka?
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tak</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Nie</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Czy szczepienia powodują autyzm?
                            </label>
                            <MatRadioGroup @bind-Value="@AnswerTest" TValue="int">
                                <MatRadioButton Value="@(AnswerTest + 0)" TValue="int">Tak</MatRadioButton>
                                <MatRadioButton Value="@(AnswerTest + 1)" TValue="int">Nie</MatRadioButton>
                            </MatRadioGroup>
                        </p>

                        <p>
                            <label>
                                Wynik = @AnswerTest
                            </label>
                        </p>
                    </div>

                    <div id="form-navigation-container">

                        <MatButton Class="previous" disabled="@wizard.PreviousButtonDisabled" @onclick="wizard.GoToPreviousStep">Cofnij</MatButton>

                        <MatButton Unelevated="true" disabled="@wizard.NextButtonDisabled" @onclick="wizard.GoToNextStep">Następna strona</MatButton>
                    </div>

                    <MatProgressBar Class="progress" Progress="@wizard.Progress" aria-valuenow="@wizard.Progress" aria-valuemin="0" aria-valuemax="1"></MatProgressBar>


            </div>
        </div>
    </div>
</div>



<div>
    <p class="alert-info">@message</p>
</div>

@code { 

    private ElementReference container;
    UserModel rUser = new UserModel();
    HistoryModel history = new HistoryModel();
    OpinionModel opinion = new OpinionModel();
    KnowledgeSourceModel knowledge = new KnowledgeSourceModel();

    Wizard wizard = new Wizard();

    protected int AnswerTest;

    string message = "";

    private EditContext editContext;

    protected override void OnInitialized()
    {
        editContext = new EditContext(rUser);
        rUser.Started_at = DateTime.Now;
    }

    void SubmitValidForm()
    {
        Console.WriteLine("Form Submitted Successfully!");
    }


    private async Task prev()
    {
        await js.InvokeVoidAsync("nextPrev", -1, container);
    }

    private async Task next()
    {
        var isValid = editContext.Validate();
        if (isValid)
        {
            await js.InvokeVoidAsync("nextPrev", 1, container);
        }

    }

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await js.InvokeVoidAsync("initializeComponent", container);
        }
    }



    private async Task HandleValidSubmit()
    {
        try
        {
            User user = new User
            {
                Age = rUser.Age,
                Gender = rUser.Gender,
                Student_eti = rUser.Student_eti,
                Education = rUser.Education,
                Started_at = rUser.Started_at,
                Completed_at = DateTime.Now,
                Result = new Result
                {
                    Score = 13
                },
                KnowledgeSource = new KnowledgeSource
                {
                    Source = knowledge.Source
                },
                Opinion = new Opinion
                {
                    CompulsoryVaccination = opinion.CompulsoryVaccination,
                    OptionalVaccination = opinion.OptionalVaccination,
                    CovidVaccination = opinion.CovidVaccination,
                    CovidVacSafety = opinion.CovidVacSafety,
                    DiseaseOrVaccine = opinion.DiseaseOrVaccine,
                    InformationTrust = opinion.InformationTrust
                },
                History = new History
                {
                    Chickenpox = history.Chickenpox,
                    Flu = history.Flu,
                    HPV = history.HPV
                }
            };
            message = "Sending the feedback";
            var response = await Http.PostAsJsonAsync("http://localhost:7071/api/SubmitSurvey", user);
            message = "Feedback stored in the destination";
        
    }
        catch (Exception ex)
    {
        message = "Failed to store your feedback";
    }
    }

    }